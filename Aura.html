<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AURA Live Radio</title>

<style>
  * { box-sizing: border-box; }
  body { margin:0; font-family:system-ui,sans-serif; }

  #container-grid {
    display:grid;
    grid-template-rows:auto 1fr auto;
    height:100vh;
    gap:0.25rem;
  }

  /* ---------------- PLAYER ---------------- */
  #player {
    display:flex;
    align-items:center;
    gap:1rem;
    padding:0.5rem;
    border-bottom:1px solid #333;
    flex-wrap:wrap;
  }
  #player audio { flex:1 1 300px; }
  #player #now-playing-container {
    display:flex;
    gap:0.5rem;
    align-items:center;
  }
  #now-playing img {
    width:50px; height:50px;
    object-fit:cover;
    border-radius:4px;
  }
  #live-status { margin-left:auto; display:flex; gap:1rem; font-size:0.9em; }

  /* ---------------- BROWSER ---------------- */
  #browser {
    display:grid;
    grid-template-columns:repeat(4,1fr);
    overflow-x:auto;
    gap:0.5rem;
    padding:0.5rem;
  }
  @media(max-width:50em){
    #browser { grid-auto-flow:column; grid-auto-columns:100%; scroll-snap-type:x mandatory; }
    .panel { scroll-snap-align:start; }
  }

  /* ---------------- PANELS ---------------- */
  .panel {
    border:1px solid #333;
    display:flex;
    flex-direction:column;
    min-height:0;
    overflow:auto;
    padding:0.5rem;
    background:#fafafa;
  }
  .panel h2 { margin:0 0 0.5rem 0; }

  /* ---------------- QUEUE ---------------- */
  #queue-list .item {
    display:flex;
    align-items:center;
    border-top:1px solid #ccc;
    border-bottom:1px solid #ccc;
    padding:0.25rem;
    gap:0.5rem;
  }
  #queue-list .item img { width:40px; height:40px; object-fit:cover; border-radius:4px; }
  #queue-list .item span { flex:1 1 auto; }

  /* ---------------- DETAIL ---------------- */
  #detail img { max-width:100%; max-height:150px; object-fit:contain; margin:0.25rem auto; display:block; }
  #related-artists, #related-albums, #related-tracks {
    display:flex; flex-wrap:wrap; gap:0.25rem;
  }
  .related-item { width:80px; text-align:center; font-size:0.8em; cursor:pointer; }
  .related-item img { width:100%; height:80px; object-fit:cover; border-radius:4px; }
</style>
</head>

<body>
<div id="container-grid">

  <!-- PLAYER -->
  <div id="player">
    <audio controls autoplay id="player-audio"></audio>
    <button id="next-track">Next Track</button>
    <button id="toggle-live">Go Live</button>
    <div id="now-playing-container">
      <img id="now-playing-cover" src="" alt="">
      <span id="now-playing">Now Playing: --</span>
    </div>
    <div id="live-status"><span id="listener-count">Listeners: 0</span></div>
  </div>

  <!-- BROWSER -->
  <div id="browser">

    <!-- REQUEST BUILDER -->
    <div id="request-builder" class="panel">
      <h2>Request Builder</h2>
      <label>Server URL
        <input type="text" id="server-url" value="http://127.0.0.1:8337/aura/">
      </label>
      <fieldset>
        <legend>Collection</legend>
        <label><input type="radio" name="collection" value="tracks" checked> Tracks</label>
        <label><input type="radio" name="collection" value="albums"> Albums</label>
        <label><input type="radio" name="collection" value="artists"> Artists</label>
      </fieldset>
      <label>Filters
        <textarea id="filters" rows="4"></textarea>
      </label>
      <label>Sort string
        <input type="text" id="sort-string">
      </label>
      <button type="button" onclick="buildAndMakeRequest()">Make Request</button>
    </div>

    <!-- RESULTS -->
    <div id="results" class="panel">
      <h2>Results</h2>
      <div id="results-list"></div>
    </div>

    <!-- DETAIL -->
    <div id="detail" class="panel">
      <h2>Detail</h2>
      <img id="item-image" alt="">
      <table id="item-attributes"></table>

      <h3>Related Artists</h3>
      <div id="related-artists"></div>

      <h3>Related Albums</h3>
      <div id="related-albums"></div>

      <h3>Related Tracks</h3>
      <div id="related-tracks"></div>
    </div>

    <!-- QUEUE -->
    <div id="queue" class="panel">
      <h2>Queue</h2>
      <div id="queue-list"></div>
    </div>

  </div>

  <!-- ACTIONS -->
  <div id="actions">
    <button onclick="clearSelection()">Clear</button>
    <button onclick="prependToQueue()">Prepend</button>
    <button onclick="appendToQueue()">Append</button>
    <button onclick="removeFromQueue()">Remove</button>
    <button onclick="playSelected()">Play</button>
  </div>

</div>

<script>
/* ---------------- LIVE RADIO LOGIC ---------------- */
const audio = document.getElementById("player-audio");
const nowPlaying = document.getElementById("now-playing");
const nowPlayingCover = document.getElementById("now-playing-cover");
let liveMode=false;
let queue=[];
let currentIndex=0;

document.getElementById("toggle-live").onclick=()=>{
  liveMode=!liveMode;
  document.getElementById("toggle-live").textContent=liveMode?"Stop Live":"Go Live";
  if(liveMode && queue.length) playTrack(currentIndex);
};

document.getElementById("next-track").onclick=()=>playNext();

function playTrack(index){
  if(!queue[index]) return;
  const track=queue[index];
  audio.src=track.url;
  audio.play();
  nowPlaying.textContent=`Now Playing: ${track.title} - ${track.artist}`;
  nowPlayingCover.src=track.cover||"";
  highlightQueueItem();
  showRelated(track);
}

function playNext(){
  if(!queue.length) return;
  currentIndex=(currentIndex+1)%queue.length;
  playTrack(currentIndex);
}

function addToQueue(track){
  queue.push(track);
  updateQueueUI();
}

function updateQueueUI(){
  const qEl=document.getElementById("queue-list");
  qEl.innerHTML="";
  queue.forEach((t,i)=>{
    const div=document.createElement("div");
    div.className="item";
    const img=document.createElement("img");
    img.src=t.cover||"";
    const span=document.createElement("span");
    span.textContent=t.title;
    div.appendChild(img);
    div.appendChild(span);
    qEl.appendChild(div);
  });
  highlightQueueItem();
}

function highlightQueueItem(){
  const items=document.querySelectorAll("#queue-list .item");
  items.forEach((el,i)=>el.style.fontWeight=i===currentIndex?"bold":"normal");
}

function showRelated(track){
  // Dummy thumbnails for demo
  const relatedTracks=document.getElementById("related-tracks");
  relatedTracks.innerHTML="";
  for(let i=1;i<=3;i++){
    const div=document.createElement("div");
    div.className="related-item";
    div.innerHTML=`<img src="${track.cover||''}" alt=""><br>${track.title} ${i}`;
    relatedTracks.appendChild(div);
  }
}

/* Example Tracks */
addToQueue({title:"Song 1", artist:"DJ A", url:"song1.mp3", cover:"cover1.jpg"});
addToQueue({title:"Song 2", artist:"DJ B", url:"song2.mp3", cover:"cover2.jpg"});
addToQueue({title:"Song 3", artist:"DJ C", url:"song3.mp3", cover:"cover3.jpg"});

audio.onended=()=>{ if(liveMode) playNext(); };

// Dummy UI functions
function clearSelection(){}
function prependToQueue(){}
function appendToQueue(){}
function removeFromQueue(){}
function playSelected(){}
function buildAndMakeRequest(){}
</script>
</body>
</html>

